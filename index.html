<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Polsia Playground</title>
<style>
body { display: flex; height: 100vh; margin: 0; }
textarea { flex: 1; padding: 10px; font-family: monospace; }
pre { flex: 1; margin: 0; padding: 10px; overflow: auto; background:#f0f0f0; white-space: pre-wrap; font-family: monospace; }
</style>
</head>
<body>
  <textarea id="input">
# Polsia (Edit me!)
# https://github.com/contagnas/polsia
# 
# Polsia is a data/configuration language, similar to CUE, and a superset of JSON

### Syntax sugar features ###
# Comments start with #
# this is a comment

# braces may be skipped in a top-level object
# {

"hello": "world",

# quotes are optional for object keys
goodbye: "moon",

# commas are optional in objects
commas: "optional"

# braces are optional for objects with a single key
foo: bar: baz: "nested"

### Unification ###
# keys may be duplicated, as long as they don't conflict
simple_string: "string"
simple_string: "string"

# Polsia has types. Types are values which unify with values of that type.
# Built-in types: Any, Nothing, Int, Number, Rational, Float, String
funny_number: Int
funny_number: 69

# Object keys are merged together
users: forest: age: 4
users: forest: species: "bear"
users: meadow: age: 4
users: meadow: species: "cat"
users: dmed: {
  age: Int
  age: 1e100
  species: "Doctor"
}

trailingCommas: true,

# } 
  </textarea>
  <pre id="output"></pre>
  <script type="module">
    import init, { polsia_to_json } from './pkg/polsia.js';
    async function run() {
        await init('./pkg/polsia_bg.wasm');
        const input = document.getElementById('input');
        const output = document.getElementById('output');
        function update() {
            try {
                output.textContent = polsia_to_json(input.value);
            } catch(e) {
                output.textContent = 'Error: ' + e;
            }
        }
        input.addEventListener('input', update);
        update();
    }
    run();
  </script>
</body>
</html>
